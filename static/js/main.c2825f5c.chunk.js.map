{"version":3,"sources":["space/Coordinate.ts","space/PERSPECTIVE.ts","space/LinePath.tsx","space/Anchor.tsx","space/MonochromeTile.tsx","entities/WorkerEntity.tsx","entities/Entity.ts","vendor/terrain.ts","scene/Scene.ts","space/MonochromeBox.tsx","space/Viewport.tsx","ui/ActiveEntityOverlay.tsx","demos/scene.hello-world.tsx","textures/nebula-282c34.png","App.tsx","index.tsx"],"names":["Coordinate","x","y","z","this","coord","dx","dy","dz","Math","abs","join","PERSPECTIVE","degrees","tileSize","isometricAngle","PI","_isometricCos","cos","_isometricSin","sin","_isometricTan","tan","tileHeight","radians","toPixels","toCoords","cartX","cartY","isoY","createPerspective","distanceToCameraComparator","a","b","dX","dY","dZ","LinePath","path","stroke","strokeWidth","spatialCoordinates","map","coordinate","cc","c","reduce","lines","start","i","all","concat","x1","y1","x2","y2","String","Crosshair","size","points","Anchor","children","crosshairSize","pixels","useMemo","overflow","MonochromeTile","fill","Color","darken","saturate","zoom","rest","string","WorkerEntity","Component","clone","location","transform","id","average","values","valid","filter","val","sum","length","Terrain","detail","max","pow","Float32Array","roughness","half","scale","square","random","diamond","divide","offset","ave","get","set","RandomScene","width","height","terrain","generate","Array","from","_","floor","entities","xy","terrainIndex","coordsToPixels","coords","borderWidth","COORDINATE_CLOSEST_TO_CAMERA","BORDER_NODES","XZ_NODES","YZ_NODES","XY_NODES","MonochromeBox","strokeLinecap","innerStroke","lighten","desaturate","innerStrokeWidth","gProps","innerStrokeCss","strokeCss","style","onClick","onContextMenu","cursor","PIXEL_FRIENDLY_PYTHAGORAS","mathRoundMaybe","n","round","AbsolutelyPositionedContainer","styled","div","Viewport","overlay","center","translateX","translateY","springStyles","ViewportSvgContainer","shapeRendering","viewBox","NoAxis","ActiveEntityOverlayWrapper","sqrt","section","ActiveEntityOverlay","HelloWorldSceneTerrain","monochromeBoxProps","useState","isHovered","setIsHovered","translated","undefined","onMouseEnter","onMouseLeave","toString","Demo","scene","centerIndex","centerCoord","setCenterCoord","slice","sort","event","preventDefault","entity","globalStyleRules","css","nebulaTexture","App","styles","component","SceneHelloWorld","ReactDOM","render","StrictMode","hashType","document","getElementById"],"mappings":"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","file":"static/js/main.c2825f5c.chunk.js","sourcesContent":["import { CoordValue, Length } from './PERSPECTIVE';\nexport interface CoordinateLike {\n\tx: CoordValue;\n\ty: CoordValue;\n\tz: CoordValue;\n}\n\nexport class Coordinate implements CoordinateLike {\n\tx: CoordValue;\n\ty: CoordValue;\n\tz: CoordValue;\n\tconstructor(x: CoordValue, y: CoordValue, z: CoordValue) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t}\n\n\tequals(coord: CoordinateLike) {\n\t\treturn (\n\t\t\tthis === coord ||\n\t\t\t(coord && this.x === coord.x && this.y === coord.y && this.z === coord.z)\n\t\t);\n\t}\n\n\ttransform(dx: Length = 0, dy: Length = 0, dz: Length = 0) {\n\t\tthis.x += dx;\n\t\tthis.y += dy;\n\t\tthis.z += dz;\n\n\t\treturn this;\n\t}\n\n\tmanhattanDistanceTo(coord: CoordinateLike) {\n\t\treturn Math.abs(this.x - coord.x) + Math.abs(this.y - coord.y); // + Math.abs(this.z - coord.z);\n\t}\n\n\t// For debugging purposes only, may change without notice or tests\n\ttoString() {\n\t\treturn [this.x, this.y, this.z].join(',');\n\t}\n\n\tstatic clone(coord: CoordinateLike) {\n\t\treturn new Coordinate(coord.x, coord.y, coord.z);\n\t}\n}\n","import { CoordinateLike } from './Coordinate';\n//     z+\n//     |     y+\n//     |    /\n//     |  /\n//     |/\n// 0,0  \\\n//        \\\n//          \\ x+\n\nconst BASE_LENGTH = 24;\n\nexport type CoordValue = number;\nexport type Length = number;\nexport type Angle = number;\nexport type CoordArray = [CoordValue, CoordValue, CoordValue];\nexport type CoordObject = { x: CoordValue; y: CoordValue; z: CoordValue };\n\nfunction createPerspective(degrees: Angle, tileSize: Length) {\n\tconst isometricAngle = degrees * (Math.PI / 180);\n\tconst _isometricCos = Math.cos(isometricAngle);\n\tconst _isometricSin = Math.sin(isometricAngle);\n\tconst _isometricTan = Math.tan(isometricAngle);\n\n\tconst tileHeight = tileSize;\n\n\treturn {\n\t\tdegrees: degrees,\n\t\tradians: degrees * (Math.PI / 180),\n\t\ttileSize: tileSize,\n\t\ttoPixels: (x: CoordValue, y: CoordValue, z: CoordValue) => {\n\t\t\tconst cartX = (x + y) * _isometricCos,\n\t\t\t\tcartY = (x - y) * _isometricSin;\n\n\t\t\treturn [\n\t\t\t\tcartX * tileSize, // x\n\t\t\t\tcartY * tileSize - tileHeight * z // y\n\t\t\t];\n\t\t},\n\t\ttoCoords: (cartX: CoordValue, cartY: CoordValue) => {\n\t\t\tconst isoY = _isometricTan * cartX + cartY,\n\t\t\t\tisoX = (cartY - isoY) / -_isometricSin - isoY;\n\n\t\t\t// this is good so far, b should be rescaled for tile size. as\n\t\t\treturn [isoX / tileSize, isoY / tileSize];\n\t\t}\n\t};\n}\n\nexport const PERSPECTIVE = createPerspective(30, BASE_LENGTH);\n\nexport function randomComparator() {\n\treturn 0.5 - Math.random();\n}\n\nexport function distanceToCameraComparator(a: CoordinateLike, b: CoordinateLike) {\n\tconst dX = b.x - a.x;\n\tif (dX) {\n\t\treturn -dX;\n\t}\n\n\tconst dY = a.y - b.y;\n\tif (dY) {\n\t\treturn -dY;\n\t}\n\tconst dZ = b.z - a.z;\n\tif (dZ) {\n\t\treturn -dZ;\n\t}\n\treturn 0;\n}\n","import React, { FunctionComponent, ReactElement } from 'react';\n\nimport { CoordArray, PERSPECTIVE } from './PERSPECTIVE';\n\nconst BORDER_WIDTH = 0;\n\nexport const LinePath: FunctionComponent<\n\tOmit<React.SVGProps<SVGLineElement>, 'path'> & {\n\t\tpath: CoordArray[];\n\t}\n> = ({ path, stroke = 'black', strokeWidth = BORDER_WIDTH }) => {\n\tlet spatialCoordinates = path\n\t\t.map(coordinate => PERSPECTIVE.toPixels(...coordinate))\n\t\t.map(cc => cc.map(c => c + BORDER_WIDTH));\n\n\treturn (\n\t\t<>\n\t\t\t{spatialCoordinates.reduce<ReactElement[]>(\n\t\t\t\t(lines, start, i, all) =>\n\t\t\t\t\ti\n\t\t\t\t\t\t? lines.concat([\n\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\tx1={start[0]}\n\t\t\t\t\t\t\t\t\ty1={start[1]}\n\t\t\t\t\t\t\t\t\tx2={all[i - 1][0]}\n\t\t\t\t\t\t\t\t\ty2={all[i - 1][1]}\n\t\t\t\t\t\t\t\t\tstroke={stroke}\n\t\t\t\t\t\t\t\t\tstrokeWidth={String(strokeWidth)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t  ])\n\t\t\t\t\t\t: lines,\n\t\t\t\t[]\n\t\t\t)}\n\t\t</>\n\t);\n};\n","import { useSpring } from '@react-spring/core';\nimport { animated } from '@react-spring/web';\nimport React, { FunctionComponent, useMemo } from 'react';\nimport { CoordinateLike } from './Coordinate';\nimport { LinePath } from './LinePath';\nimport { CoordArray, Length, PERSPECTIVE } from './PERSPECTIVE';\n\nconst Crosshair: FunctionComponent<{ size: Length }> = ({ size = 4 }) => {\n\tconst lines: CoordArray[][] = [\n\t\t[\n\t\t\t// over the x axis\n\t\t\t[-1 * size, 0, 0],\n\t\t\t[size, 0, 0]\n\t\t],\n\t\t[\n\t\t\t// over the y axis\n\t\t\t[0, -1 * size, 0],\n\t\t\t[0, size, 0]\n\t\t],\n\t\t[\n\t\t\t// over the z axis\n\t\t\t[0, 0, -1 * size],\n\t\t\t[0, 0, size]\n\t\t]\n\t];\n\n\treturn (\n\t\t<>\n\t\t\t{lines.map((points, i) => (\n\t\t\t\t<LinePath key={i} path={points} stroke={'rgba(0,0,0)'} strokeWidth={0.5} />\n\t\t\t))}\n\t\t</>\n\t);\n};\n\nexport const Anchor: FunctionComponent<\n\t{\n\t\tcrosshairSize?: Length;\n\t} & Partial<CoordinateLike>\n> = ({ x = 0, y = 0, z = 0, children, crosshairSize = 0 }) => {\n\tconst pixels = useMemo(() => PERSPECTIVE.toPixels(x, y, z), [x, y, z]);\n\n\treturn (\n\t\t<svg x={pixels[0]} y={pixels[1]} overflow={'visible'}>\n\t\t\t{crosshairSize ? <Crosshair size={crosshairSize} /> : null}\n\t\t\t{children}\n\t\t</svg>\n\t);\n};\n\nexport const MovingAnchor: FunctionComponent<{\n\tmoveTo: CoordinateLike;\n\tcrosshairSize?: Length;\n}> = ({ moveTo, children, crosshairSize = 0 }) => {\n\tconst [dx, dy] = useMemo(() => PERSPECTIVE.toPixels(moveTo.x, moveTo.y, moveTo.z), [moveTo]);\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst [ix, iy] = useMemo(() => [dx, dy], []);\n\n\tconst loc = useSpring({\n\t\tto: {\n\t\t\tx: dx,\n\t\t\ty: dy\n\t\t},\n\t\tconfig: {\n\t\t\tduration: 2500\n\t\t},\n\t\tfrom: {\n\t\t\tx: ix,\n\t\t\ty: iy\n\t\t}\n\t});\n\n\t// @TODO reuse <Anchor>\n\treturn (\n\t\t<animated.svg x={loc.x} y={loc.y} overflow={'visible'}>\n\t\t\t{crosshairSize ? <Crosshair size={crosshairSize} /> : null}\n\t\t\t{children}\n\t\t</animated.svg>\n\t);\n};\n","import Color from 'color';\nimport React, { FunctionComponent } from 'react';\n\nimport { CoordArray, PERSPECTIVE } from './PERSPECTIVE';\n\nconst BORDER_WIDTH = 1;\nconst BORDER_NODES: CoordArray[] = [\n\t[1, 0, 0],\n\t[1, 1, 0],\n\t[0, 1, 0],\n\t[0, 0, 0]\n];\n\nlet spatialCoordinates = BORDER_NODES.map(coordinate => PERSPECTIVE.toPixels(...coordinate)).map(\n\tcc => cc.map(c => c + BORDER_WIDTH)\n);\n\nexport const MonochromeTile: FunctionComponent<\n\t{\n\t\tzoom?: number;\n\t\tfill?: Color;\n\t\tstroke?: Color;\n\t} & React.SVGProps<SVGPolygonElement>\n> = ({\n\tfill = Color('#282c34'), //.lighten(0.3),\n\n\tstroke = fill.darken(0.3).saturate(0.3),\n\tstrokeWidth = BORDER_WIDTH,\n\tzoom = 1,\n\t...rest\n}) => {\n\treturn (\n\t\t<polygon\n\t\t\tpoints={spatialCoordinates.map(c => c.map(c => c * zoom).join(',')).join(' ')}\n\t\t\tstroke={stroke.string()}\n\t\t\tfill={fill.string()}\n\t\t\tstrokeWidth={strokeWidth}\n\t\t\t{...rest}\n\t\t/>\n\t);\n};\n","import React, { FunctionComponent } from 'react';\nimport { Anchor } from '../space/Anchor';\nimport { Coordinate } from '../space/Coordinate';\nimport { MonochromeTile } from '../space/MonochromeTile';\nimport { Entity } from './Entity';\n\nexport class WorkerEntity extends Entity {\n\tComponent: FunctionComponent = () => {\n\t\tconst zoom = 0.5;\n\n\t\tconst translate = zoom / 2;\n\t\treturn (\n\t\t\t<Anchor {...Coordinate.clone(this.location).transform(-translate, -translate, 0)}>\n\t\t\t\t<MonochromeTile zoom={zoom} />\n\t\t\t</Anchor>\n\t\t);\n\t\t// return <circle cx={x} cy={y} r=\"5\" fill=\"white\" />;\n\t};\n}\n","import { FunctionComponent } from 'react';\nimport { Coordinate } from '../space/Coordinate';\n\nexport class Entity {\n\tpublic readonly id: string;\n\tpublic readonly location: Coordinate;\n\tconstructor(id: string, location: Coordinate) {\n\t\tthis.id = id;\n\t\tthis.location = location;\n\t}\n\tpublic readonly Component: FunctionComponent = () => {\n\t\treturn null;\n\t};\n}\n","/**\n * Adapted from\n *   https://github.com/hunterloftis/playfuljs-demos/blob/gh-pages/terrain/index.html#L118\n */\n\nfunction average(values: number[]) {\n\tvar valid = values.filter(function (val) {\n\t\treturn val !== -1;\n\t});\n\tvar total = valid.reduce(function (sum, val) {\n\t\treturn sum + val;\n\t}, 0);\n\treturn total / valid.length;\n}\n\nexport class Terrain {\n\tsize: number;\n\tmax: number;\n\tmap: Float32Array;\n\n\tconstructor(detail: number) {\n\t\tthis.size = Math.pow(2, detail) + 1;\n\t\tthis.max = this.size - 1;\n\t\tthis.map = new Float32Array(this.size * this.size);\n\t}\n\n\tget(x: number, y: number) {\n\t\tif (x < 0 || x > this.max || y < 0 || y > this.max) {\n\t\t\t// Out of bounds\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.map[x + this.size * y];\n\t}\n\n\tset(x: number, y: number, val: number) {\n\t\tthis.map[x + this.size * y] = val;\n\t}\n\n\tdivide(size: number, roughness: number) {\n\t\tvar x,\n\t\t\ty,\n\t\t\thalf = size / 2;\n\t\tvar scale = roughness * size;\n\t\tif (half < 1) return;\n\n\t\tfor (y = half; y < this.max; y += size) {\n\t\t\tfor (x = half; x < this.max; x += size) {\n\t\t\t\tthis.square(x, y, half, Math.random() * scale * 2 - scale);\n\t\t\t}\n\t\t}\n\t\tfor (y = 0; y <= this.max; y += half) {\n\t\t\tfor (x = (y + half) % size; x <= this.max; x += size) {\n\t\t\t\tthis.diamond(x, y, half, Math.random() * scale * 2 - scale);\n\t\t\t}\n\t\t}\n\t\tthis.divide(size / 2, roughness);\n\t}\n\n\tsquare(x: number, y: number, size: number, offset: number) {\n\t\tvar ave = average([\n\t\t\tthis.get(x - size, y - size), // upper left\n\t\t\tthis.get(x + size, y - size), // upper right\n\t\t\tthis.get(x + size, y + size), // lower right\n\t\t\tthis.get(x - size, y + size) // lower left\n\t\t]);\n\t\tthis.set(x, y, ave + offset);\n\t}\n\n\tdiamond(x: number, y: number, size: number, offset: number) {\n\t\tvar ave = average([\n\t\t\tthis.get(x, y - size), // top\n\t\t\tthis.get(x + size, y), // right\n\t\t\tthis.get(x, y + size), // bottom\n\t\t\tthis.get(x - size, y) // left\n\t\t]);\n\t\tthis.set(x, y, ave + offset);\n\t}\n\n\tgenerate(roughness: number) {\n\t\tthis.set(0, 0, this.max);\n\t\tthis.set(this.max, 0, this.max / 2);\n\t\tthis.set(this.max, this.max, 0);\n\t\tthis.set(0, this.max, this.max / 2);\n\n\t\tthis.divide(this.max, roughness);\n\t}\n}\n","import { Coordinate } from '../space/Coordinate';\nimport { Entity } from '../entities/Entity';\nimport { WorkerEntity } from '../entities/WorkerEntity';\nimport { Terrain } from '../vendor/terrain';\n\nexport class Scene {\n\tpublic terrain: Coordinate[] = [];\n\tpublic entities: Entity[] = [];\n}\n\nexport class RandomScene extends Scene {\n\tconstructor(width: number, height: number) {\n\t\tsuper();\n\n\t\tconst terrain = new Terrain(9);\n\t\tterrain.generate(1);\n\n\t\tthis.terrain = Array.from(new Array(width * height)).map((_, i) => {\n\t\t\tconst x = i % width;\n\t\t\tconst y = Math.floor(i / width);\n\t\t\tconst z = terrain.get(x, y);\n\t\t\treturn new Coordinate(x, y, (z - 512) / 20);\n\t\t});\n\t\tthis.entities = Array.from(new Array(100)).map((_, i) => {\n\t\t\tconst xy = {\n\t\t\t\tx: Math.floor(Math.random() * width),\n\t\t\t\ty: Math.floor(Math.random() * height)\n\t\t\t};\n\t\t\tconst terrainIndex = xy.y * width + xy.x;\n\t\t\treturn new WorkerEntity(\n\t\t\t\t'entity-' + i,\n\t\t\t\tCoordinate.clone({\n\t\t\t\t\t...xy,\n\t\t\t\t\tz: this.terrain[terrainIndex].z\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t}\n}\n","import Color from 'color';\nimport React, { FunctionComponent } from 'react';\nimport { CoordArray, Length, PERSPECTIVE } from './PERSPECTIVE';\n\nconst BORDER_WIDTH = 0;\n\nfunction coordsToPixels(coords: CoordArray[], borderWidth = BORDER_WIDTH) {\n\treturn coords\n\t\t.map(coordinate => PERSPECTIVE.toPixels(...coordinate))\n\t\t.map(cc => cc.map(c => c + borderWidth));\n}\n\nconst COORDINATE_CLOSEST_TO_CAMERA = PERSPECTIVE.toPixels(1, 0, 1).map(c => c + BORDER_WIDTH);\n\nlet BORDER_NODES = coordsToPixels([\n\t[1, 1, 0], // 0\n\t[1, 1, 1],\n\t[0, 1, 1], // 2\n\t[0, 0, 1],\n\t[0, 0, 0], // 4\n\t[1, 0, 0]\n]);\n\n// facing to the bottom left, aka -y\nlet XZ_NODES = coordsToPixels([\n\t[0, 0, 0],\n\t[0, 0, 1],\n\t[1, 0, 1],\n\t[1, 0, 0]\n]);\n\n// facing to the bottom right, aka +x\nlet YZ_NODES = coordsToPixels([\n\t[1, 0, 0],\n\t[1, 1, 0],\n\t[1, 1, 1],\n\t[1, 0, 1]\n]);\n\n// facing top, aka +z\nlet XY_NODES = coordsToPixels([\n\t[0, 0, 1],\n\t[1, 0, 1],\n\t[1, 1, 1],\n\t[0, 1, 1]\n]);\n\nexport const MonochromeBox: FunctionComponent<\n\t{\n\t\tstrokeLinecap?: 'round' | 'butt' | 'square' | 'inherit' | undefined;\n\t\tfill?: Color;\n\t\tstroke?: Color;\n\t\tstrokeWidth?: Length;\n\t\tinnerStrokeWidth?: Length;\n\t\tinnerStroke?: Color;\n\t} & Pick<\n\t\tReact.SVGProps<SVGGElement>,\n\t\t'onClick' | 'onContextMenu' | 'onMouseEnter' | 'onMouseLeave'\n\t>\n> = ({\n\tfill = Color('#282c34'),\n\tstrokeLinecap = 'round',\n\tstroke = fill.darken(0.3).saturate(0.3),\n\tstrokeWidth = 1,\n\tinnerStroke = fill.lighten(0.4).desaturate(0.8),\n\tinnerStrokeWidth = strokeWidth,\n\t...gProps\n}) => {\n\tconst innerStrokeCss = innerStroke && innerStroke.string();\n\tconst strokeCss = stroke && stroke.string();\n\n\tconst style: Record<string, string> = {};\n\tif (gProps.onClick || gProps.onContextMenu) {\n\t\tstyle.cursor = 'pointer';\n\t}\n\n\treturn (\n\t\t<g {...gProps} style={style}>\n\t\t\t{fill && (\n\t\t\t\t<>\n\t\t\t\t\t<polygon\n\t\t\t\t\t\tkey={'xz'}\n\t\t\t\t\t\tpoints={XZ_NODES.map(c => c.join(',')).join(' ')}\n\t\t\t\t\t\tfill={fill.string()}\n\t\t\t\t\t\tstrokeWidth={0}\n\t\t\t\t\t/>\n\t\t\t\t\t<polygon\n\t\t\t\t\t\tkey={'xy'}\n\t\t\t\t\t\tpoints={XY_NODES.map(c => c.join(',')).join(' ')}\n\t\t\t\t\t\tfill={fill.lighten(0.2).string()}\n\t\t\t\t\t\tstrokeWidth={0}\n\t\t\t\t\t/>\n\t\t\t\t\t<polygon\n\t\t\t\t\t\tkey={'yz'}\n\t\t\t\t\t\tpoints={YZ_NODES.map(c => c.join(',')).join(' ')}\n\t\t\t\t\t\tfill={fill.darken(0.2).string()}\n\t\t\t\t\t\tstrokeWidth={0}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{innerStroke && (\n\t\t\t\t<>\n\t\t\t\t\t<line\n\t\t\t\t\t\tkey={'x-bar'}\n\t\t\t\t\t\tx1={COORDINATE_CLOSEST_TO_CAMERA[0]}\n\t\t\t\t\t\ty1={COORDINATE_CLOSEST_TO_CAMERA[1]}\n\t\t\t\t\t\tx2={BORDER_NODES[3][0]}\n\t\t\t\t\t\ty2={BORDER_NODES[3][1]}\n\t\t\t\t\t\tstroke={innerStrokeCss}\n\t\t\t\t\t\tstrokeWidth={innerStrokeWidth}\n\t\t\t\t\t\tstrokeLinecap={strokeLinecap}\n\t\t\t\t\t/>\n\t\t\t\t\t<line\n\t\t\t\t\t\tkey={'y-bar'}\n\t\t\t\t\t\tx1={COORDINATE_CLOSEST_TO_CAMERA[0]}\n\t\t\t\t\t\ty1={COORDINATE_CLOSEST_TO_CAMERA[1]}\n\t\t\t\t\t\tx2={BORDER_NODES[1][0]}\n\t\t\t\t\t\ty2={BORDER_NODES[1][1]}\n\t\t\t\t\t\tstroke={innerStrokeCss}\n\t\t\t\t\t\tstrokeWidth={innerStrokeWidth}\n\t\t\t\t\t\tstrokeLinecap={strokeLinecap}\n\t\t\t\t\t/>\n\t\t\t\t\t<line\n\t\t\t\t\t\tkey={'z-bar'}\n\t\t\t\t\t\tx1={COORDINATE_CLOSEST_TO_CAMERA[0]}\n\t\t\t\t\t\ty1={COORDINATE_CLOSEST_TO_CAMERA[1]}\n\t\t\t\t\t\tx2={BORDER_NODES[5][0]}\n\t\t\t\t\t\ty2={BORDER_NODES[5][1]}\n\t\t\t\t\t\tstroke={innerStrokeCss}\n\t\t\t\t\t\tstrokeWidth={innerStrokeWidth}\n\t\t\t\t\t\tstrokeLinecap={strokeLinecap}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t<polygon\n\t\t\t\tkey={'outline'}\n\t\t\t\tpoints={BORDER_NODES.map(c => c.join(',')).join(' ')}\n\t\t\t\tstroke={strokeCss}\n\t\t\t\tfill={'transparent'}\n\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\tstrokeLinecap={strokeLinecap}\n\t\t\t/>\n\t\t</g>\n\t);\n};\n","import styled from '@emotion/styled';\nimport React, { FunctionComponent, ReactElement, useMemo } from 'react';\nimport { AnimatedComponent } from 'react-spring';\nimport { CoordinateLike } from './Coordinate';\nimport { Length, PERSPECTIVE } from './PERSPECTIVE';\n\n// The pythagoras distance (1/sqrt(2)) with a little tweaking for better looks\nconst PIXEL_FRIENDLY_PYTHAGORAS = 1 / Math.pow(2, 1 / 2); //0.8;\n\nfunction mathRoundMaybe(n: number) {\n\t// For debugging only. Adjust to taste.\n\n\treturn Math.round(n);\n\t// return n;\n}\n\n// Force the type to AnimatedComponent to avoid a weird TS inference bug\n//\nexport const AbsolutelyPositionedContainer = styled.div`\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\twidth: 0;\n\theight: 0;\n\ttransition: transform 0.5s;\n\t> * {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t}\n` as unknown as AnimatedComponent<'div'>;\n\ntype ViewportComponentProps = {\n\tzoom?: number;\n\tcenter?: CoordinateLike;\n\toverlay?: ReactElement;\n};\n\nexport const Viewport: FunctionComponent<ViewportComponentProps> = ({\n\toverlay,\n\tcenter = { x: 0, y: 0, z: 0 },\n\tzoom = 1,\n\tchildren\n}) => {\n\tconst [translateX, translateY] = useMemo(\n\t\t() =>\n\t\t\tPERSPECTIVE.toPixels(center.x, center.y, center.z).map(\n\t\t\t\t(n, i) => mathRoundMaybe(-n) + (i ? 0 : 0.5)\n\t\t\t),\n\t\t[center]\n\t);\n\n\tconst springStyles =\n\t\t//useSpring({\n\t\t// \tconfig: config.molasses,\n\t\t// \tto:\n\t\t{\n\t\t\ttransform: `translate(\n\t\t\t\t${translateX * zoom}px,\n\t\t\t\t${translateY * zoom}px\n\t\t\t)`\n\t\t};\n\t// });\n\n\treturn (\n\t\t<AbsolutelyPositionedContainer style={springStyles}>\n\t\t\t<ViewportSvgContainer zoom={zoom} children={children} />\n\t\t\t{overlay}\n\t\t</AbsolutelyPositionedContainer>\n\t);\n};\n\nexport const ViewportSvgContainer: FunctionComponent<\n\t{\n\t\tzoom?: number;\n\t} & React.SVGProps<SVGSVGElement>\n> = ({ zoom = 1, ...rest }) => (\n\t<svg\n\t\twidth=\"1px\"\n\t\theight=\"1px\"\n\t\toverflow=\"visible\"\n\t\tshapeRendering=\"geometricPrecision\"\n\t\tviewBox={[0, 0, 1 / zoom, 1 / zoom].join(' ')}\n\t\t{...rest}\n\t/>\n);\n\nconst NoAxis = styled.div<{ zoom?: number }>`\n\t--scale-val: ${({ zoom = 1 }) => zoom};\n\n\tposition: absolute;\n\ttransform-origin: top left;\n\ttransform: scale(var(--scale-val));\n`;\n\nconst YAxis = styled(NoAxis)`\n\ttransform: skewY(-${PERSPECTIVE.degrees}deg)\n\t\tscale(calc(${PIXEL_FRIENDLY_PYTHAGORAS} * var(--scale-val)), var(--scale-val));\n`;\n\nconst ZAxis = styled(NoAxis)`\n\ttransform: rotate(-${PERSPECTIVE.degrees}deg) skewX(${PERSPECTIVE.degrees}deg)\n\t\tscale(\n\t\t\tcalc(${Math.sqrt(PIXEL_FRIENDLY_PYTHAGORAS)} * var(--scale-val)),\n\t\t\tcalc(${PIXEL_FRIENDLY_PYTHAGORAS} * var(--scale-val))\n\t\t);\n`;\n\nconst XAxis = styled(NoAxis)`\n\ttransform: skewY(${PERSPECTIVE.degrees}deg)\n\t\tscale(calc(${PIXEL_FRIENDLY_PYTHAGORAS} * var(--scale-val)), var(--scale-val));\n`;\n\nexport const ViewportHtmlContainer: FunctionComponent<{\n\taxis?: 'x' | 'y' | 'z';\n\twidth: Length;\n\theight: Length;\n\tzoom?: number;\n\tlocation: CoordinateLike;\n}> = ({ location, zoom = 1, axis, width, height, children }) => {\n\tconst { x, y, z } = location,\n\t\t// @TODO use css variable to zoom instead of JS\n\t\t[left, top] = PERSPECTIVE.toPixels(x, y, z).map(n => mathRoundMaybe(n * zoom));\n\t// @TODO use css variable to zoom instead of JS\n\tconst [pixelWidth] = PERSPECTIVE.toPixels(0, width, height).map(n => mathRoundMaybe(n * zoom));\n\tconst Axis = axis === 'y' ? YAxis : axis === 'x' ? XAxis : axis === 'z' ? ZAxis : NoAxis;\n\treturn (\n\t\t<Axis\n\t\t\tzoom={zoom}\n\t\t\tstyle={{\n\t\t\t\tleft: mathRoundMaybe(left),\n\t\t\t\ttop: mathRoundMaybe(top),\n\t\t\t\twidth:\n\t\t\t\t\tmathRoundMaybe(axis ? pixelWidth / PIXEL_FRIENDLY_PYTHAGORAS : pixelWidth) +\n\t\t\t\t\t'px',\n\t\t\t\theight:\n\t\t\t\t\tMath.abs(\n\t\t\t\t\t\t(height * PERSPECTIVE.tileSize) /\n\t\t\t\t\t\t\t(axis === 'z' ? PIXEL_FRIENDLY_PYTHAGORAS : 1)\n\t\t\t\t\t) + 'px'\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</Axis>\n\t);\n};\n","// const ActiveEntityOverlay: FunctionComponent = ({ children }) => null;\n\nimport styled from '@emotion/styled';\nimport React, { FunctionComponent } from 'react';\n\n// const ActiveEntityOverlay: FunctionComponent = ({ children }) => null;\nconst ActiveEntityOverlayWrapper = styled.section`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n`;\n\nexport const ActiveEntityOverlay: FunctionComponent = () => (\n  <ActiveEntityOverlayWrapper>\n    <p>Heyyoo</p>\n  </ActiveEntityOverlayWrapper>\n);\n","import Color from 'color';\nimport React, { FunctionComponent, useMemo, useState } from 'react';\nimport { RandomScene } from '../scene/Scene';\nimport { Anchor } from '../space/Anchor';\nimport { Coordinate } from '../space/Coordinate';\nimport { MonochromeBox } from '../space/MonochromeBox';\nimport { distanceToCameraComparator } from '../space/PERSPECTIVE';\nimport { Viewport } from '../space/Viewport';\nimport { ActiveEntityOverlay } from '../ui/ActiveEntityOverlay';\n\nconst HelloWorldSceneTerrain: FunctionComponent<\n\t{\n\t\tcoordinate: Coordinate;\n\t} & (typeof MonochromeBox extends FunctionComponent<infer T> ? T : {})\n> = ({ coordinate: coord, ...monochromeBoxProps }) => {\n\tconst [isHovered, setIsHovered] = useState(false);\n\tconst translated = Coordinate.clone(coord).transform(-0.5, -0.5, -1);\n\treturn (\n\t\t<Anchor key={translated.toString()} x={translated.x} y={translated.y} z={translated.z}>\n\t\t\t<MonochromeBox\n\t\t\t\t{...monochromeBoxProps}\n\t\t\t\tfill={isHovered ? Color('#282c34').lighten(1) : undefined}\n\t\t\t\tstroke={isHovered ? Color('#fff') : undefined}\n\t\t\t\tinnerStroke={isHovered ? Color('#ccd1dd') : undefined}\n\t\t\t\tonMouseEnter={() => setIsHovered(true)}\n\t\t\t\tonMouseLeave={() => setIsHovered(false)}\n\t\t\t/>\n\t\t</Anchor>\n\t);\n};\n\nconst Demo: FunctionComponent = () => {\n\tconst size = 40;\n\tconst scene = useMemo(() => new RandomScene(size, size), []);\n\tconst centerIndex = Math.floor((size + 1 - (size % 2)) * (size / 2));\n\tconst [centerCoord, setCenterCoord] = useState(scene.terrain[centerIndex]);\n\n\tconst zoomFactor = 1;\n\n\tconst terrain = useMemo(\n\t\t() =>\n\t\t\tscene.terrain\n\t\t\t\t.slice()\n\t\t\t\t.sort(distanceToCameraComparator)\n\t\t\t\t.map(coord => (\n\t\t\t\t\t<HelloWorldSceneTerrain\n\t\t\t\t\t\tkey={coord.toString()}\n\t\t\t\t\t\tcoordinate={coord}\n\t\t\t\t\t\tonClick={event => {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tsetCenterCoord(coord);\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t)),\n\t\t[scene.terrain]\n\t);\n\n\tconst entities = useMemo(\n\t\t() =>\n\t\t\tscene.entities\n\t\t\t\t.slice()\n\t\t\t\t.sort((a, b) => distanceToCameraComparator(a.location, b.location))\n\t\t\t\t.map(entity => {\n\t\t\t\t\tconst Component = entity.Component;\n\t\t\t\t\treturn <Component key={entity.id} />;\n\t\t\t\t}),\n\t\t[scene.entities]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<Viewport center={centerCoord} zoom={zoomFactor}>\n\t\t\t\t<g id=\"scene-terrain\">{terrain}</g>\n\t\t\t\t<g id=\"scene-entities\">{entities}</g>\n\t\t\t</Viewport>\n\t\t\t<ActiveEntityOverlay />\n\t\t</>\n\t);\n};\nexport default Demo;\n","export default __webpack_public_path__ + \"static/media/nebula-282c34.dda754f6.png\";","import { css, Global } from '@emotion/react';\nimport React from 'react';\nimport { Route } from 'react-router';\nimport SceneHelloWorld from './demos/scene.hello-world';\nimport nebulaTexture from './textures/nebula-282c34.png';\n\nconst globalStyleRules = css`\n\tbody {\n\t\tbackground: url(${nebulaTexture});\n\t}\n`;\nfunction App() {\n\treturn (\n\t\t<>\n\t\t\t<Global styles={globalStyleRules} />\n\t\t\t<Route path=\"/\" component={SceneHelloWorld} />\n\t\t</>\n\t);\n}\n\nexport default App;\n","import { HashRouter } from 'react-router-dom';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<HashRouter hashType={'slash'}>\n\t\t\t<App />\n\t\t</HashRouter>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n);\n"],"sourceRoot":""}